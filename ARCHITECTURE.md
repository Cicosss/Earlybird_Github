# ğŸ—ï¸ EarlyBird V8.0 - Architecture Documentation

## Overview

EarlyBird Ã¨ un sistema di betting intelligence **self-learning** che utilizza triangolazione multi-fonte, AI reasoning, Verification Layer e ottimizzazione quantitativa. Il sistema impara dai propri risultati, adattando automaticamente i pesi delle strategie in base a Sortino Ratio, CLV e Max Drawdown.

**V8.0 Highlights**:
- ğŸ”„ **Doppio Ciclo API Tavily**: Rotazione intelligente con reset mensile prima del fallback (fino a 14000 chiamate/mese)
- ğŸ¯ **Elite Quality Filtering**: Raised alert thresholds (Standard: 9.0, Radar: 7.5) to reduce volume and increase quality
- ğŸ” **Tavily AI Search**: 7 API keys rotation con circuit breaker e doppio ciclo + fallback Brave/DDG
- âœ… **Verification Layer**: Fact-checking alerts con multi-site queries prima dell'invio
- ğŸ“ˆ **CLV Tracker**: Closing Line Value monitoring per edge validation
- ğŸ¤– **DeepSeek Primary**: Provider AI principale via OpenRouter (no cooldown needed)
- ğŸ”’ **Sample Size Guards**: FROZEN/WARMING/ACTIVE states per optimizer
- ğŸ”§ **Enhanced News Source Verification**: Intelligent confidence adjustment based on source credibility (2026-01-17)

**V6.0 Highlights**:
- ğŸ¦ **Twitter Intel Cache**: Sostituisce broken site:twitter.com search
- âš¡ **Parallel Enrichment**: FotMob calls parallelizzate (~15s â†’ ~4s per match)
- ğŸ“¦ **Discovery Queue**: Thread-safe communication per Browser Monitor

## Security

EarlyBird implements comprehensive security measures to protect sensitive data and ensure system integrity:

### Security Status (January 2026)
- âœ… **No Backdoors**: All unauthorized access mechanisms have been completely removed
- âœ… **Verified Codebase**: Comprehensive security audit completed
- âœ… **Secure Deployment**: Standard deployment methods with no hidden access points

### Security Measures
- **API Key Management**: All credentials stored in `.env` file (excluded from version control)
- **Database Security**: SQLite with WAL mode, connection pooling, and proper timeout handling
- **Network Security**: No open ports, outbound connections only, rate limiting
- **Input Validation**: Centralized validators and contract testing
- **VPS Security**: Comprehensive best practices for secure deployment

### What Was Removed
As part of the January 2026 security cleanup, the following unauthorized components were removed:
- `backdoor_config.sh` - SSH reverse tunnel configuration
- `deploy_to_vps_with_backdoor.sh` - Deployment script with backdoor
- `setup_backdoor_ubuntu24.sh` - Backdoor setup script
- `audit_logger.py` - Backdoor monitoring system

**Note**: All legitimate proxy functionality (Twitter proxy, corner proxy, cache bypass) remains as these are standard features for data acquisition.

For detailed security information, see [`SECURITY.md`](SECURITY.md).

## System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EARLYBIRD V7.2 PIPELINE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   TRIGGER   â”‚  Every 120 minutes
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 1: DATA INGESTION (Tiered Global Coverage)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ODDS API       â”‚    â”‚  FOTMOB         â”‚    â”‚  TELEGRAM       â”‚      â”‚
â”‚  â”‚  (30+ Leagues)  â”‚    â”‚  (Stats/Context)â”‚    â”‚  (Insider)      â”‚      â”‚
â”‚  â”‚  regions:       â”‚    â”‚  Parallel calls â”‚    â”‚  OCR enabled    â”‚      â”‚
â”‚  â”‚  us,uk,eu,au    â”‚    â”‚  (V6.0)         â”‚    â”‚  for images     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                  â–¼                                       â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚   RESOURCE GATEKEEPER   â”‚                          â”‚
â”‚                    â”‚  Tier 1: Always scan    â”‚                          â”‚
â”‚                    â”‚  Tier 2: Round robin    â”‚                          â”‚
â”‚                    â”‚  Emergency: Tier1 only  â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 2: CONTEXT ENRICHMENT (FotMob + Weather) - PARALLEL V6.0          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  For each match in window (2h - 96h):                                    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  PARALLEL ENRICHMENT (V6.0) â­ NEW                               â”‚    â”‚
â”‚  â”‚  File: src/utils/parallel_enrichment.py                         â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Concurrent calls (max_workers=4, timeout=45s):                 â”‚    â”‚
â”‚  â”‚  â€¢ get_full_team_context(home) + get_full_team_context(away)    â”‚    â”‚
â”‚  â”‚  â€¢ get_turnover_risk(home) + get_turnover_risk(away)            â”‚    â”‚
â”‚  â”‚  â€¢ get_referee_info() + get_stadium_coordinates()               â”‚    â”‚
â”‚  â”‚  â€¢ get_team_stats(home) + get_team_stats(away)                  â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Performance: ~15s â†’ ~4s per match                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  TEAM CONTEXT ENGINE                                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚  INJURIES    â”‚  â”‚  MOTIVATION  â”‚  â”‚   FATIGUE    â”‚           â”‚    â”‚
â”‚  â”‚  â”‚  Squad scan  â”‚  â”‚  Position:   â”‚  â”‚  V2.0 Engine â”‚           â”‚    â”‚
â”‚  â”‚  â”‚  for injured â”‚  â”‚  â€¢ Title     â”‚  â”‚  â€¢ Exp decay â”‚           â”‚    â”‚
â”‚  â”‚  â”‚  & suspended â”‚  â”‚  â€¢ Europe    â”‚  â”‚  â€¢ Squad dep â”‚           â”‚    â”‚
â”‚  â”‚  â”‚              â”‚  â”‚  â€¢ Relegationâ”‚  â”‚  â€¢ Late-game â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  WEATHER INTELLIGENCE                                            â”‚    â”‚
â”‚  â”‚  Source: Open-Meteo API (free, no key required)                 â”‚    â”‚
â”‚  â”‚  Impact: Wind >40km/h, Rain >5mm â†’ Under/Cards signals          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 3: MATH ENGINE (Poisson + Kelly + Dixon-Coles)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  POISSON MODEL (Dixon-Coles Enhanced)                            â”‚    â”‚
â”‚  â”‚  â€¢ Ï parameter: -0.07 (low-scoring correlation)                 â”‚    â”‚
â”‚  â”‚  â€¢ League-specific Home Advantage (0.22-0.40 goal boost)        â”‚    â”‚
â”‚  â”‚  â€¢ Output: Win/Draw/Away probabilities, xG, Most Likely Score   â”‚    â”‚
â”‚  â”‚  â€¢ Reliability: Requires >= 5 matches sample size               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  KELLY CRITERION                                                 â”‚    â”‚
â”‚  â”‚  Formula: f* = (bp - q) / b                                     â”‚    â”‚
â”‚  â”‚  Safety Cap: Max 5% stake per bet                               â”‚    â”‚
â”‚  â”‚  Low Odds Rejection: <= 1.05 rejected                           â”‚    â”‚
â”‚  â”‚  Output: Suggested stake %, Edge %, Value flag (edge > 5%)      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 4: MARKET INTELLIGENCE (V7.0 ENHANCED)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  REVERSE LINE MOVEMENT                                           â”‚    â”‚
â”‚  â”‚  â€¢ 65%+ pubblico su HOME ma quote HOME salgono â†’ Sharp su AWAY  â”‚    â”‚
â”‚  â”‚  â€¢ Threshold: RLM_PUBLIC_THRESHOLD = 0.65                       â”‚    â”‚
â”‚  â”‚  â€¢ Odds increase: RLM_ODDS_INCREASE_THRESHOLD = 3%              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STEAM MOVE DETECTION                                            â”‚    â”‚
â”‚  â”‚  â€¢ Time Window: 15 minuti (uniforme per Elite 7)                â”‚    â”‚
â”‚  â”‚  â€¢ Threshold: Drop > 5% (STEAM_MOVE_THRESHOLD_PCT)              â”‚    â”‚
â”‚  â”‚  â€¢ Rapid Steam: < 5 minuti = HIGH confidence                    â”‚    â”‚
â”‚  â”‚  â€¢ Tabella: odds_snapshots per tracking storico                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  NEWS DECAY (League-Adaptive)                                    â”‚    â”‚
â”‚  â”‚  Formula: Impact_t = Impact_0 * e^(-Î»t)                         â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Tier 1 Leagues (PL, La Liga): Î» = 0.14 (half-life ~5 min)     â”‚    â”‚
â”‚  â”‚  Elite Leagues (Turkey, etc): Î» = 0.023 (half-life ~30 min)    â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Freshness Tags: ğŸ”¥ FRESH (<60min), â° AGING, ğŸ“œ STALE          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  BISCOTTO ENGINE V2.0                                            â”‚    â”‚
â”‚  â”‚  â€¢ Z-Score vs league avg (28%): >2.0 = anomaly                  â”‚    â”‚
â”‚  â”‚  â€¢ End-of-Season: Last 5 rounds detection                       â”‚    â”‚
â”‚  â”‚  â€¢ Mutual Benefit: Both teams need 1 point                      â”‚    â”‚
â”‚  â”‚  â€¢ Pattern: DRIFT (gradual) vs CRASH (sudden)                   â”‚    â”‚
â”‚  â”‚  File: src/analysis/biscotto_engine.py                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FATIGUE ENGINE V2.0                                             â”‚    â”‚
â”‚  â”‚  â€¢ Exponential decay: recent matches weight more (1/days_ago)   â”‚    â”‚
â”‚  â”‚  â€¢ Squad depth: Elite=0.5x, Top=0.7x, Mid=1.0x, Low=1.3x       â”‚    â”‚
â”‚  â”‚  â€¢ 21-day rolling window analysis                               â”‚    â”‚
â”‚  â”‚  â€¢ Late-game risk: >40% probability = HIGH risk                 â”‚    â”‚
â”‚  â”‚  File: src/analysis/fatigue_engine.py                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 5: NEWS HUNTING (Multi-Tier + Tavily) â­ V7.0 UPDATED             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  TIER 0: BROWSER MONITOR (Active Web Monitoring)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Playwright + DeepSeek AI analysis                               â”‚    â”‚
â”‚  â”‚  Real-time monitoring of configured sources                      â”‚    â”‚
â”‚  â”‚  Confidence: HIGH, Priority Boost: 2.0                          â”‚    â”‚
â”‚  â”‚  Discovery Queue: Thread-safe storage (V6.0)                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  TIER 0.5: TWITTER INTEL CACHE (V7.0) â­ NEW                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Replaces broken site:twitter.com search                        â”‚    â”‚
â”‚  â”‚  Cache populated at cycle start via DeepSeek + Nitter           â”‚    â”‚
â”‚  â”‚  Beat writers + insider accounts from config                    â”‚    â”‚
â”‚  â”‚  Relevance filter with freshness decay                          â”‚    â”‚
â”‚  â”‚  File: src/services/twitter_intel_cache.py                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  TIER 1: SEARCH ENGINES (Tavily â†’ Brave â†’ DDG â†’ Serper)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Primary: Tavily AI Search (14000/month, Doppio Ciclo) â­ V8.0     â”‚    â”‚
â”‚  â”‚  Fallback 1: Brave Search API (2000/month)                      â”‚    â”‚
â”‚  â”‚  Fallback 2: DuckDuckGo (ddgs) - FREE, no API key               â”‚    â”‚
â”‚  â”‚  Emergency: Serper (API) - PAID                                 â”‚    â”‚
â”‚  â”‚  Anti-Ban: Jitter 3-6s + Stealth Headers                        â”‚    â”‚
â”‚  â”‚  DEEP DIVE ON DEMAND â­ V8.0 NEW: Upgrade shallow search results   â”‚    â”‚
â”‚  â”‚  to full article content when high-value keywords detected                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  ORCHESTRATOR: news_hunter.py                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ Aggrega tutti i tier in ordine (0 â†’ 0.5 â†’ 1)                 â”‚    â”‚
â”‚  â”‚  â€¢ Multi-source correlation (+15% confidence boost)             â”‚    â”‚
â”‚  â”‚  â€¢ Sport filtering (no basket/women/futsal)                     â”‚    â”‚
â”‚  â”‚  â€¢ Graceful fallback se tier non disponibile                    â”‚    â”‚
â”‚  â”‚  â€¢ V8.0: Reddit removed (no betting edge)                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 6: AI ANALYSIS (DeepSeek V3 via OpenRouter)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  INPUT (6 Data Sources):                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ NEWS   â”‚ â”‚ MARKET â”‚ â”‚ FOTMOB â”‚ â”‚ STATS  â”‚ â”‚WEATHER â”‚ â”‚TWITTER â”‚     â”‚
â”‚  â”‚DOSSIER â”‚ â”‚ STATUS â”‚ â”‚CONTEXT â”‚ â”‚(Goals/ â”‚ â”‚ IMPACT â”‚ â”‚ INTEL  â”‚     â”‚
â”‚  â”‚        â”‚ â”‚+ Sharp â”‚ â”‚+ Math  â”‚ â”‚ Cards) â”‚ â”‚        â”‚ â”‚ CACHE  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                          â”‚
â”‚  INTELLIGENCE ROUTER (V7.0):                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  File: src/services/intelligence_router.py                       â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  1. Tavily pre-enrichment (match context)                       â”‚    â”‚
â”‚  â”‚  2. DeepSeek V3 analysis (primary)                              â”‚    â”‚
â”‚  â”‚  3. Perplexity Sonar fallback (on errors)                       â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  No cooldown needed (DeepSeek high rate limits)                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  OUTPUT (JSON - Italian):                                                â”‚
â”‚  {                                                                       â”‚
â”‚    "final_verdict": "BET" | "NO BET",                                   â”‚
â”‚    "confidence": 0-100,                                                  â”‚
â”‚    "primary_market": "Home Win" | "Over 2.5" | ...,                     â”‚
â”‚    "combo_suggestion": "Home Win + Over 2.5" | null,                    â”‚
â”‚    "primary_driver": "INJURY_INTEL" | "SHARP_MONEY" | "MATH_VALUE" |   â”‚
â”‚                       "CONTEXT_PLAY" | "CONTRARIAN",                    â”‚
â”‚    "reasoning": "Italian explanation"                                   â”‚
â”‚  }                                                                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 7: VERIFICATION LAYER (V7.0) â­ NEW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  File: src/analysis/verification_layer.py                                â”‚
â”‚                                                                          â”‚
â”‚  PURPOSE: Fact-check alerts before sending to prevent false positives    â”‚
â”‚  TRIGGER: Score >= 7.5 (VERIFICATION_SCORE_THRESHOLD)                    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  MULTI-SITE QUERY BUILDER                                        â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Site Priority per data type:                                   â”‚    â”‚
â”‚  â”‚  â€¢ Team stats: footystats.org > soccerstats.com > flashscore    â”‚    â”‚
â”‚  â”‚  â€¢ Player values: transfermarkt.com > sofifa.com                â”‚    â”‚
â”‚  â”‚  â€¢ Form: flashscore.com > soccerway.com > sofascore             â”‚    â”‚
â”‚  â”‚  â€¢ Referee: transfermarkt.com > soccerway.com                   â”‚    â”‚
â”‚  â”‚  â€¢ H2H: footystats.org > soccerstats.com > flashscore           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ENHANCED NEWS SOURCE VERIFICATION (2026-01-17) â­ NEW          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  â€¢ Source credibility assessment via existing weighting system   â”‚    â”‚
â”‚  â”‚  â€¢ Intelligent confidence adjustment based on net impact       â”‚    â”‚
â”‚  â”‚  â€¢ Cross-source verification requirements                      â”‚    â”‚
â”‚  â”‚  â€¢ Integration with Perplexity AI verification                  â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Decision Matrix:                                               â”‚    â”‚
â”‚  â”‚  â€¢ Net Impact >= 2: Upgrade confidence                           â”‚    â”‚
â”‚  â”‚  â€¢ Net Impact <= -1: Downgrade confidence                         â”‚    â”‚
â”‚  â”‚  â€¢ -1 < Net Impact < 2: Maintain confidence                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  PLAYER IMPACT ANALYSIS                                          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Market Value â†’ Impact Score:                                   â”‚    â”‚
â”‚  â”‚  â€¢ â‚¬80M+ = 10 (world class)                                     â”‚    â”‚
â”‚  â”‚  â€¢ â‚¬60-80M = 9 (elite)                                          â”‚    â”‚
â”‚  â”‚  â€¢ â‚¬40-60M = 8 (key player)                                     â”‚    â”‚
â”‚  â”‚  â€¢ â‚¬25-40M = 7 (important)                                      â”‚    â”‚
â”‚  â”‚  â€¢ â‚¬15-25M = 6 (regular starter)                                â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Critical threshold: Total impact >= 20                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  VERIFICATION OUTCOMES                                           â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  CONFIRM: Alert proceeds with original/adjusted score           â”‚    â”‚
â”‚  â”‚  REJECT: Alert blocked (critical inconsistencies)               â”‚    â”‚
â”‚  â”‚  CHANGE_MARKET: Alternative market suggested                    â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Score Adjustments:                                             â”‚    â”‚
â”‚  â”‚  â€¢ Critical injury + Over market: -1.5 points                   â”‚    â”‚
â”‚  â”‚  â€¢ Form warning: -0.5 points                                    â”‚    â”‚
â”‚  â”‚  â€¢ Per inconsistency: -0.3 points                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 8: OPTIMIZER (Self-Learning with CLV) â­ V5.0 UPDATED             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  SAMPLE SIZE GUARDS (V5.0) â­ NEW                                 â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  State Machine per prevenire overfitting:                       â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  FROZEN (< 30 bets):                                            â”‚    â”‚
â”‚  â”‚    â†’ weight = 1.0 (no adjustment)                               â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  WARMING_UP (30-50 bets):                                       â”‚    â”‚
â”‚  â”‚    â†’ max Â±0.1 adjustment                                        â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  ACTIVE (50+ bets):                                             â”‚    â”‚
â”‚  â”‚    â†’ full optimization enabled                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  CLV TRACKER INTEGRATION (V5.0) â­ NEW                           â”‚    â”‚
â”‚  â”‚  File: src/analysis/clv_tracker.py                              â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  CLV = (odds_taken / fair_closing_odds) - 1                     â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Benchmarks:                                                    â”‚    â”‚
â”‚  â”‚  â€¢ CLV > +2% = EXCELLENT edge                                   â”‚    â”‚
â”‚  â”‚  â€¢ CLV > +0.5% = GOOD edge                                      â”‚    â”‚
â”‚  â”‚  â€¢ CLV > 0% = MARGINAL edge                                     â”‚    â”‚
â”‚  â”‚  â€¢ CLV <= 0% = NO EDGE                                          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Edge Validation:                                               â”‚    â”‚
â”‚  â”‚  is_validated = (avg_clv > 0 AND bets >= 20 AND positive > 50%) â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  SELF-HEALING MECHANISM (only in ACTIVE state)                   â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Sortino Ratio: risk-adjusted return (penalizes downside only)  â”‚    â”‚
â”‚  â”‚  Max Drawdown: largest peak-to-trough decline                   â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  IF Drawdown > 20%:                                             â”‚    â”‚
â”‚  â”‚    â†’ CUT weight by 50%                                          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  IF Sortino > 1.5:                                              â”‚    â”‚
â”‚  â”‚    â†’ BOOST weight by 20%                                        â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Weights persisted to: data/optimizer_weights.json              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 9: ALERT DISPATCH                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  THRESHOLD: Score >= 9.0 ("Elite Quality" - V8.7 Quality Boost)              â”‚
â”‚                                                                          â”‚
â”‚  DEDUPLICATION:                                                          â”‚
â”‚  â€¢ Track highest_score_sent per match in DB                             â”‚
â”‚  â€¢ Alert only if: score >= 9.0 AND (first_alert OR delta >= 1.5)       â”‚
â”‚                                                                          â”‚
â”‚  DYNAMIC THRESHOLD (V6.0+):                                              â”‚
â”‚  â€¢ Base: 9.0 (adaptive based on performance)                           â”‚
â”‚  â€¢ Bounds: 7.5 - 9.0 (auto-adjustment)                                 â”‚
â”‚  â€¢ Factors: Drawdown, Sortino, Win Rate                                â”‚
â”‚                                                                          â”‚
â”‚  RADAR BOOST (Intelligence-Only):                                       â”‚
â”‚  â€¢ Lower threshold: 7.5 with forced_narrative                         â”‚
â”‚  â€¢ For hidden opportunities with qualitative signals                   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  TELEGRAM MESSAGE (Italian)                                      â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  ğŸš¨ EARLYBIRD ALERT | Turkey Super Lig                          â”‚    â”‚
â”‚  â”‚  âš½ Galatasaray vs Fenerbahce                                    â”‚    â”‚
â”‚  â”‚  ğŸ“Š Punteggio: 8.5/10                                           â”‚    â”‚
â”‚  â”‚  ğŸ“ˆ Quote: 1.85 â†’ 1.72                                          â”‚    â”‚
â”‚  â”‚  ğŸ’ VALORE INTATTO (+7.0%)                                      â”‚    â”‚
â”‚  â”‚  ğŸ¯ Mercato Consigliato: Home Win                               â”‚    â”‚
â”‚  â”‚  ğŸ§© COMBO SMART: Home Win + Over 2.5                            â”‚    â”‚
â”‚  â”‚  ğŸ§® VALORE MATEMATICO: Edge +8.2%, Stake 3% (Kelly)             â”‚    â”‚
â”‚  â”‚  âœ… VERIFICATO (Verification Layer)                             â”‚    â”‚
â”‚  â”‚  ğŸ“ [Reasoning in Italian]                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 10: NIGHTLY SETTLEMENT & CLV (04:00 UTC)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  SETTLER                                                         â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  1. Query matches with alerts sent (highest_score_sent >= 7)    â”‚    â”‚
â”‚  â”‚  2. Fetch final scores from FotMob                              â”‚    â”‚
â”‚  â”‚  3. Evaluate bet outcome (WIN/LOSS/PUSH)                        â”‚    â”‚
â”‚  â”‚  4. Calculate ROI per bet                                       â”‚    â”‚
â”‚  â”‚  5. Calculate CLV (odds_taken vs closing_odds) â­ V5.0          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Supported Markets:                                              â”‚    â”‚
â”‚  â”‚  â€¢ Home Win, Away Win, Draw                                     â”‚    â”‚
â”‚  â”‚  â€¢ Double Chance (1X, X2)                                       â”‚    â”‚
â”‚  â”‚  â€¢ Over/Under 1.5, 2.5                                          â”‚    â”‚
â”‚  â”‚  â€¢ BTTS (Both Teams To Score)                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  CLV REPORT (V5.0) â­ NEW                                        â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Included in nightly settlement:                                â”‚    â”‚
â”‚  â”‚  â€¢ Average CLV per strategy                                     â”‚    â”‚
â”‚  â”‚  â€¢ Positive CLV rate                                            â”‚    â”‚
â”‚  â”‚  â€¢ Edge validation status per strategy                          â”‚    â”‚
â”‚  â”‚  â€¢ Tavily verification of line movement causes                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  OPTIMIZER RECALIBRATION                                         â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  Input: Settlement stats + CLV data                             â”‚    â”‚
â”‚  â”‚  Process:                                                        â”‚    â”‚
â”‚  â”‚  1. Calculate Sortino Ratio per strategy                        â”‚    â”‚
â”‚  â”‚  2. Calculate Max Drawdown per strategy                         â”‚    â”‚
â”‚  â”‚  3. Check CLV validation status                                 â”‚    â”‚
â”‚  â”‚  4. Adjust weights (respecting sample size guards)              â”‚    â”‚
â”‚  â”‚  5. Persist to data/optimizer_weights.json                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PHASE 11: TELEGRAM COMMAND CENTER                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  File: src/run_bot.py                                                    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  AVAILABLE COMMANDS (Admin Only)                                 â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  /stat    - Genera grafico Profitti & ROI (PNG)                 â”‚    â”‚
â”‚  â”‚  /debug   - Mostra ultimi 15 errori/warning dal log             â”‚    â”‚
â”‚  â”‚  /report  - Scarica CSV storico scommesse (7 giorni)            â”‚    â”‚
â”‚  â”‚  /settle  - Calcola risultati scommesse (72h) + CLV             â”‚    â”‚
â”‚  â”‚  /status  - Stato provider AI e Browser Monitor â­ V5.0         â”‚    â”‚
â”‚  â”‚  /stop    - Pausa il loop di analisi â­ V5.0                    â”‚    â”‚
â”‚  â”‚  /resume  - Riprendi il loop di analisi â­ V5.0                 â”‚    â”‚
â”‚  â”‚  /ping    - Test risposta rapida ("Pong!")                      â”‚    â”‚
â”‚  â”‚  /help    - Lista comandi disponibili                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## Database Schema

### SQLite Configuration (WAL Mode)

```python
# WAL Mode per concorrenza (evita "database is locked")
engine = create_engine(
    f"sqlite:///{db_path}",
    connect_args={
        "check_same_thread": False,
        "timeout": 30  # busy_timeout=30000ms
    },
    pool_pre_ping=True
)

# Pragma settings
@event.listens_for(engine, "connect")
def set_sqlite_pragma(dbapi_connection, connection_record):
    cursor = dbapi_connection.cursor()
    cursor.execute("PRAGMA journal_mode=WAL")
    cursor.execute("PRAGMA synchronous=NORMAL")
    cursor.execute("PRAGMA busy_timeout=30000")
    cursor.close()
```

### matches Table
```sql
CREATE TABLE matches (
    id TEXT PRIMARY KEY,
    league TEXT,
    home_team TEXT,
    away_team TEXT,
    start_time DATETIME,
    
    -- Opening odds (NEVER updated after first insert)
    opening_home_odd FLOAT,
    opening_draw_odd FLOAT,
    opening_away_odd FLOAT,
    
    -- Current odds (updated each cycle)
    current_home_odd FLOAT,
    current_draw_odd FLOAT,
    current_away_odd FLOAT,
    
    -- Sharp odds analysis
    sharp_bookie TEXT,
    sharp_home_odd FLOAT,
    sharp_draw_odd FLOAT,
    sharp_away_odd FLOAT,
    avg_home_odd FLOAT,
    avg_draw_odd FLOAT,
    avg_away_odd FLOAT,
    is_sharp_drop BOOLEAN DEFAULT FALSE,
    sharp_signal TEXT,
    
    -- Alert flags (spam prevention)
    odds_alert_sent BOOLEAN DEFAULT FALSE,
    biscotto_alert_sent BOOLEAN DEFAULT FALSE,
    sharp_alert_sent BOOLEAN DEFAULT FALSE,
    
    -- Score-delta deduplication
    highest_score_sent FLOAT DEFAULT 0.0,
    
    -- Deep dive tracking (V6.0)
    last_deep_dive_time DATETIME,
    
    last_updated DATETIME
);
```

### news_logs Table
```sql
CREATE TABLE news_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    match_id TEXT REFERENCES matches(id),
    url TEXT,
    summary TEXT,
    score INTEGER,
    category TEXT,
    affected_team TEXT,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    sent BOOLEAN DEFAULT FALSE,
    
    -- Combo bet fields
    combo_suggestion TEXT,
    combo_reasoning TEXT,
    recommended_market TEXT,
    
    -- Quantitative fields
    primary_driver TEXT,
    closing_odds FLOAT,
    
    -- CLV Tracking (V5.0)
    odds_taken FLOAT,
    clv_percent FLOAT
);
```

### odds_snapshots Table
```sql
CREATE TABLE odds_snapshots (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    match_id TEXT NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    home_odd FLOAT,
    draw_odd FLOAT,
    away_odd FLOAT,
    
    sharp_home_odd FLOAT,
    sharp_draw_odd FLOAT,
    sharp_away_odd FLOAT,
    sharp_bookie TEXT
);

CREATE INDEX idx_snapshot_match_time ON odds_snapshots (match_id, timestamp);
```


## Component Details

### 0. News Radar Monitor (Autonomous 24/7 Hunter) â­ CRITICAL

**File**: `src/services/news_radar.py` + `run_news_radar.py`

**Purpose**: Componente completamente autonomo che monitora fonti web 24/7 per scoprire notizie betting-relevant su leghe minori NON coperte dal bot principale.

**Differenze dal Browser Monitor**:
| Aspetto | Browser Monitor | News Radar |
|---------|-----------------|------------|
| Integrazione | Alimenta il pipeline principale | Completamente indipendente |
| Database | Scrive su NewsLog | Nessuna interazione DB |
| Alert | Via analyzer â†’ notifier | Diretto su Telegram |
| Target | Leghe Elite/Tier1 | Leghe minori non coperte |

**Flow**:
```
1. Load sources from config/news_radar_sources.json
2. Loop continuo (default 5 min interval)
3. Extract page text (HTTP + Trafilatura, fallback Playwright)
4. Apply exclusion filters (basketball, women's, youth, NFL, etc.)
5. Analyze relevance (injuries, suspensions, etc.)
6. If ambiguous (0.5-0.7 confidence): call DeepSeek for deeper analysis
7. If relevant (confidence >= 0.7): send Telegram alert
8. Deduplicate using content hash cache (24h TTL)
```

**Key Classes**:
```python
@dataclass
class RadarSource:
    url: str
    name: str
    priority: int = 1
    scan_interval_minutes: int = 5
    navigation_mode: str = "single"  # or "paginated"
    link_selector: Optional[str] = None

@dataclass
class RadarAlert:
    source_name: str
    affected_team: str
    category: str  # MASS_ABSENCE, DECIMATED, YOUTH_TEAM, etc.
    absent_count: int
    betting_impact: str  # CRITICAL, HIGH, MEDIUM, LOW
    confidence: float
```

**Confidence Thresholds**:
```python
DEEPSEEK_CONFIDENCE_THRESHOLD = 0.5  # Below: skip
ALERT_CONFIDENCE_THRESHOLD = 0.7     # Above: alert directly
# Between 0.5-0.7: call DeepSeek for deeper analysis
```

**Content Extraction** (Hybrid approach):
1. HTTP + Trafilatura (fast, ~80% success)
2. Playwright fallback with stealth mode (~95% success)

**Circuit Breaker** (per-source):
```python
CIRCUIT_BREAKER_FAILURE_THRESHOLD = 3   # Open after 3 failures
CIRCUIT_BREAKER_RECOVERY_TIMEOUT = 300  # 5 min recovery
States: CLOSED â†’ OPEN â†’ HALF_OPEN â†’ CLOSED
```

**Deduplication**:
- Content hash cache (first 1000 chars)
- LRU eviction (max 5000 entries)
- 24h TTL per entry

**Alert Format** (Telegram):
```
ğŸ”” RADAR ALERT ğŸš¨ âš ï¸

Squadra: Torino
Categoria: MASS_ABSENCE
âš½ Partita: Torino vs Juventus (Serie A)
ğŸ“… Data: 2026-01-15
âŒ Assenti: 7 giocatori
   Zapata, Ricci, Bellanova, +4 altri

ğŸ“‹ Riepilogo: Il Torino affronta il derby...

Fonte: tuttosport.com
ğŸ”— https://...

_Impatto betting: CRITICAL | AffidabilitÃ : 85%_
```

**Configuration** (`config/news_radar_sources.json`):
```json
{
  "global_settings": {
    "default_scan_interval_minutes": 5,
    "page_timeout_seconds": 30,
    "cache_ttl_hours": 24,
    "deepseek_confidence_threshold": 0.5,
    "alert_confidence_threshold": 0.7
  },
  "sources": [
    {
      "url": "https://example.com/news",
      "name": "Example News",
      "priority": 1,
      "scan_interval_minutes": 10,
      "navigation_mode": "single"
    }
  ]
}
```

**Tavily Budget**: 1500 calls/month (21% of total budget)

**Fallback Chain**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NEWS RADAR FALLBACK CHAIN                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  CONTENT EXTRACTION:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ HTTP +       â”‚ â”€â”€â–º â”‚ Playwright   â”‚ â”€â”€â–º â”‚ Skip URL     â”‚    â”‚
â”‚  â”‚ Trafilatura  â”‚     â”‚ (stealth)    â”‚     â”‚ (log error)  â”‚    â”‚
â”‚  â”‚ (~80% OK)    â”‚     â”‚ (~95% OK)    â”‚     â”‚              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  AI ANALYSIS (confidence 0.5-0.7):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ DeepSeek V3  â”‚ â”€â”€â–º â”‚ Skip alert   â”‚ â”€â”€â–º â”‚ (no Perplexityâ”‚   â”‚
â”‚  â”‚ (OpenRouter) â”‚     â”‚ (low conf)   â”‚     â”‚  fallback)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  PRE-ENRICHMENT (V7.0 - Optional):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ Tavily       â”‚ â”€â”€â–º â”‚ Continue     â”‚  (enrichment optional)  â”‚
â”‚  â”‚ (if budget)  â”‚     â”‚ without      â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                 â”‚
â”‚  PER-SOURCE CIRCUIT BREAKER:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CLOSED       â”‚ â”€â”€â–º â”‚ OPEN         â”‚ â”€â”€â–º â”‚ HALF_OPEN    â”‚    â”‚
â”‚  â”‚ (normal)     â”‚     â”‚ (skip 5min)  â”‚     â”‚ (test 1 req) â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Resilience Features**:
- **Circuit Breaker per-source**: Ogni URL ha il suo circuit breaker (3 failures â†’ 5 min skip)
- **Browser Auto-Recovery**: Se Playwright crasha, viene ricreato automaticamente
- **Hot Reload Config**: Modifica `news_radar_sources.json` senza restart
- **Graceful Shutdown**: SIGINT/SIGTERM gestiti correttamente
- **Content Cache**: Evita re-analisi dello stesso contenuto (24h TTL)

**Launcher**: `python run_news_radar.py [--config CONFIG_FILE]`

---

### 1. Tavily AI Search Provider (V7.0) â­ NEW

**File**: `src/ingestion/tavily_provider.py`

**Features**:
- 7 API keys rotation (1000 calls each = 7000/month)
- Circuit breaker with Brave/DDG fallback
- Response caching (30 min TTL)
- Rate limiting (1 req/sec)

**Circuit Breaker**:
```python
CIRCUIT_BREAKER_THRESHOLD = 3      # Open after 3 consecutive failures
CIRCUIT_BREAKER_RECOVERY_SECONDS = 60
CIRCUIT_BREAKER_SUCCESS_THRESHOLD = 2  # Close after 2 successes

States: CLOSED â†’ OPEN â†’ HALF_OPEN â†’ CLOSED
```

**Budget Manager** (`src/ingestion/tavily_budget.py`):
```python
TAVILY_BUDGET_ALLOCATION = {
    "main_pipeline": 2100,      # 30%
    "news_radar": 1500,         # 21%
    "browser_monitor": 750,     # 11%
    "telegram_monitor": 450,    # 6%
    "settlement_clv": 225,      # 3%
    "twitter_recovery": 1975,   # 29% buffer
}
```

### 2. Intelligence Router (V7.0)

**File**: `src/services/intelligence_router.py`

**Routing Logic**:
1. Tavily pre-enrichment (match context)
2. DeepSeek V3 analysis (primary)
3. Perplexity Sonar fallback (on errors)

**Key Methods**:
- `get_match_deep_dive()`: Deep analysis with Tavily enrichment
- `verify_news_batch()`: News verification with Tavily pre-filter
- `confirm_biscotto()`: Biscotto evidence search
- `enrich_match_context()`: Tavily + DeepSeek combined

### 3. Verification Layer (V7.0) â­ NEW

**File**: `src/analysis/verification_layer.py`

**Data Classes**:
- `VerificationRequest`: Input DTO with match/injury data
- `VerifiedData`: Aggregated data from external sources
- `VerificationResult`: Output with status/adjustments

**Key Functions**:
- `verify_alert()`: Main verification entry point
- `should_verify_alert()`: Check if score meets threshold
- `create_verification_request_from_match()`: Factory function

**Thresholds** (from `config/settings.py`):
```python
VERIFICATION_SCORE_THRESHOLD = 7.5
PLAYER_KEY_IMPACT_THRESHOLD = 7
CRITICAL_IMPACT_THRESHOLD = 20
CRITICAL_INJURY_OVER_PENALTY = 1.5
FORM_WARNING_PENALTY = 0.5
INCONSISTENCY_PENALTY = 0.3
```

### 4. CLV Tracker (V5.0) â­ NEW

**File**: `src/analysis/clv_tracker.py`

**Key Methods**:
- `calculate_clv()`: Single bet CLV calculation
- `get_clv_stats()`: Aggregated statistics
- `get_strategy_edge_report()`: Edge validation per strategy
- `generate_clv_report()`: Human-readable report
- `get_clv_for_optimizer()`: Data for weight adjustment

**Edge Validation Logic**:
```python
is_validated = (
    avg_clv > 0 and 
    bets_with_clv >= 20 and
    positive_clv_rate > 50%
)
```

### 5. Optimizer (V5.0)

**File**: `src/analysis/optimizer.py`

**Sample Size Guards**:
```python
MIN_SAMPLE_SIZE = 30      # FROZEN below this
WARMING_SAMPLE_SIZE = 50  # Full optimization above this

class OptimizerState(Enum):
    FROZEN = "frozen"           # weight = 1.0
    WARMING_UP = "warming_up"   # max Â±0.1
    ACTIVE = "active"           # full optimization
```

### 6. News Hunter

**File**: `src/processing/news_hunter.py`

**Search Priority**:
1. Browser Monitor discoveries (TIER 0)
2. Twitter Intel Cache (TIER 0.5)
3. Tavily AI Search (TIER 1 primary)
4. Brave/DDG/Serper (TIER 1 fallback)

**Freshness Module** (`src/utils/freshness.py`):
```python
FRESHNESS_FRESH_THRESHOLD_MIN = 60    # ğŸ”¥ FRESH
FRESHNESS_AGING_THRESHOLD_MIN = 360   # â° AGING
# Above 360 min = ğŸ“œ STALE
```

### 7. Twitter Intel Cache (V7.0)

**File**: `src/services/twitter_intel_cache.py`

**Features**:
- Populated at cycle start
- DeepSeek + Nitter extraction
- Relevance filtering per match
- Conflict detection (Twitter vs FotMob)

**File**: `src/services/tweet_relevance_filter.py`
- AI scoring for match relevance
- Freshness decay weighting
- Max 5 tweets per match


## Scheduled Tasks

| Task | Time (UTC) | Function | Description |
|------|------------|----------|-------------|
| Settlement + CLV | 04:00 | `run_nightly_settlement()` | Verify results, calculate CLV, update optimizer |
| Pipeline | Every 120m | `run_pipeline()` | Main analysis cycle |
| Heartbeat | Every 4h | `send_heartbeat()` | System health check |
| Browser Monitor | Continuous | `BrowserMonitor.run()` | Active web monitoring |
| News Radar | Continuous | `NewsRadarMonitor.run()` | Autonomous news hunting |

## Deployment

### Headless Mode

EarlyBird operates in **headless mode** - no web dashboard required.
All output is via Telegram and CLI logs.

```bash
# VPS Production
screen -S earlybird ./run_forever.sh

# Detach: Ctrl+A, D
# Reattach: screen -r earlybird
```

### Watchdog Features (run_forever.sh)

- Auto-restart on crash (exponential backoff)
- Crash counter (max 10/hour)
- Memory error detection
- Connection error handling
- Stability reset after 5 min uptime

## Configuration Reference

### Home Advantage by League (config/settings.py)

```python
HOME_ADVANTAGE_BY_LEAGUE = {
    # HIGH HA (0.35-0.45)
    "soccer_turkey_super_league": 0.38,
    "soccer_greece_super_league": 0.40,
    "soccer_argentina_primera_division": 0.38,
    
    # MEDIUM HA (0.25-0.35)
    "soccer_france_ligue_one": 0.28,
    "soccer_italy_serie_a": 0.28,
    
    # LOW HA (0.20-0.25)
    "soccer_england_premier_league": 0.25,
    "soccer_germany_bundesliga": 0.22,
}
DEFAULT_HOME_ADVANTAGE = 0.30
```

### News Decay by League Tier

```python
# Tier 1 (fast markets): Î» = 0.14 (half-life ~5 min)
TIER1_LEAGUES = {
    "soccer_england_premier_league",
    "soccer_spain_la_liga",
    "soccer_italy_serie_a",
    # ...
}

# Elite leagues (slower markets): Î» = 0.023 (half-life ~30 min)
NEWS_DECAY_LAMBDA_TIER1 = 0.14
NEWS_DECAY_LAMBDA_ELITE = 0.023
```

### Tavily Budget Thresholds

```python
TAVILY_MONTHLY_BUDGET = 7000
TAVILY_DEGRADED_THRESHOLD = 0.90   # 90% - throttle non-critical
TAVILY_DISABLED_THRESHOLD = 0.95   # 95% - only critical calls
```

---

*EarlyBird V7.2 Architecture - Last Updated: January 2026*
*Powered by DeepSeek V3 + Tavily AI Search + Verification Layer + CLV Tracking*
